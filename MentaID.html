
<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="The number of biological databases is growing rapidly, but different databases use different IDs to refer to the same biological entity. The inconsistency in IDs impedes the integration of various types of biological data. To resolve the problem, we developed MantaID, a data-driven, machine-learning based approach that automates identifying IDs on a large scale. The MantaID models prediction accuracy was proven to be 99%, and it correctly and effectively predicted 100,000 ID entries within two minutes. MantaID supports the discovery and exploitation of ID patterns from large quantities of databases. (e.g., up to 542 biological databases). An easy-to-use freely available open-source software R package, a user-friendly web application, and APIs were also developed for MantaID to improve applicability. To our knowledge, MantaID' is the first tool that enables an automatic, quick, accurate, and comprehensive identification of large quantities of IDs, and can therefore be used as a starting point to facilitate the complex assimilation and aggregation of biological data across diverse databases.">
<title>A Machine-Learning Based Tool to Automate the Identification of Biological Database IDs • MantaID</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="A Machine-Learning Based Tool to Automate the Identification of Biological Database IDs">
<meta property="og:description" content="The number of biological databases is growing rapidly, but different databases use different IDs to refer to the same biological entity. The inconsistency in IDs impedes the integration of various types of biological data. To resolve the problem, we developed MantaID, a data-driven, machine-learning based approach that automates identifying IDs on a large scale. The MantaID models prediction accuracy was proven to be 99%, and it correctly and effectively predicted 100,000 ID entries within two minutes. MantaID supports the discovery and exploitation of ID patterns from large quantities of databases. (e.g., up to 542 biological databases). An easy-to-use freely available open-source software R package, a user-friendly web application, and APIs were also developed for MantaID to improve applicability. To our knowledge, MantaID' is the first tool that enables an automatic, quick, accurate, and comprehensive identification of large quantities of IDs, and can therefore be used as a starting point to facilitate the complex assimilation and aggregation of biological data across diverse databases.">
<meta property="og:image" content="https://molaison.github.io/MantaID/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">MantaID</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="mantaid-">MantaID 
<a class="anchor" aria-label="anchor" href="#mantaid-"></a>
</h1>
</div>
<style type="text/css">
p {
    margin-top: 0;
    margin-bottom: 1.5rem;
    padding: 0px 2%;    
}
h2,h3{
    margin-bottom: 20px;    
}
pre{
    margin: 2%;
}
</style>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This tutorial introduces MantaID, a machine-learning-based tool to automate the identification of biological database IDs. IDs are required for simple access to biological data and for facilitating cross-referencing between databases. However, the lack of universal agreement on the composition of a database ID, results in the situation that the same biological entity may have various IDs. Current ID conversion tools all require previous knowledge of the database to which they belong and are incapable of identifying the IDs in the absence of database names. MantaID bridges this gap enabling the identification of IDs, facilitating the text-mining in scientific documents and ID conversion. Additionally, a shiny application is offered, accessible via <a href="https://molaison.shinyapps.io/MantaID/" class="external-link">MantaID (shinyapps.io)</a> and API via <a href="http://164.92.98.237/MantaIDapi/__docs__/" class="external-link">MantaIDapi</a>.</p>
</div>
<div class="section level2">
<h2 id="how-to-use-mantaid">How to use MantaID?<a class="anchor" aria-label="anchor" href="#how-to-use-mantaid"></a>
</h2>
<p>The computational framework and all the approaches of MantaID are implemented as a software package that handles all the different steps of the model development process and makes it easy to create user-defined ID recognition models by adjusting a few parameters.</p>
<div class="section level3">
<h3 id="preparation-and-session-set-up">Preparation and session set up<a class="anchor" aria-label="anchor" href="#preparation-and-session-set-up"></a>
</h3>
<p>This tutorial is based on R. If you have not installed R, you will find an introduction to run it in your computer <a href="https://rstudio-education.github.io/hopr/starting.html" class="external-link">here</a>. Before turning to the workflow, please install all the packages by running the code below.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span>,repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"remotes"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span>,repos <span class="op">=</span> <span class="st">"http://cran.us.r-project.org"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BiocManager</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"biomaRt"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">BiocManager</span><span class="fu">::</span><span class="fu">install</span><span class="op">(</span><span class="st">"biomaRt"</span>, version <span class="op">=</span> <span class="st">"3.16"</span><span class="op">)</span></span>
<span><span class="fu">install_bitbucket</span><span class="op">(</span><span class="st">"Molaison/MantaID"</span><span class="op">)</span></span></code></pre></div>
<p>Next, we load the <code>MantaID</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://molaison.github.io/MantaID/">MantaID</a></span><span class="op">)</span></span></code></pre></div>
<p>Because deep-learning is achieved in MantaID by calling <code>tensorflow</code> via the <code>keras</code> package, so <code>python</code> and <code>tensorflow</code> need to be installed first.</p>
<ol style="list-style-type: decimal">
<li><p>To install python and tensorflow dependencies, please follow the instructions provided by Tensorflow via <a href="https://www.tensorflow.org/install/pip?hl=zh-cn#system-install" class="external-link">TensorFlow installation</a>.</p></li>
<li><p>Use tensorflow in R. Please replace “/path/to/python.exe” with your python path.</p></li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"reticulate"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/" class="external-link">reticulate</a></span><span class="op">)</span></span>
<span><span class="co"># path_to_python &lt;- use_python(python = "/path/to/python.exe")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-preprocessing">Data preprocessing<a class="anchor" aria-label="anchor" href="#data-preprocessing"></a>
</h3>
<p>This section illustrates how to procure data for training with <code>biomaRt</code> package. To give <code>MantaID</code> a test drive, we use human genome-related datasets to train a <code>MantaID</code> model. Users can specify another dataset or use customized ID data. First, use <code>mi_get_ID_attr</code> function to get the attributes of the dataset associated with the ID. Then, with the attributes screened out, retrieve the corresponding data as a data frame with two columns, <code>ID</code> and <code>class</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">attributes</span> <span class="op">=</span> <span class="fu"><a href="reference/mi_get_ID_attr.html">mi_get_ID_attr</a></span><span class="op">(</span>biomart <span class="op">=</span> <span class="st">"genes"</span>, dataset <span class="op">=</span> <span class="st">"hsapiens_gene_ensembl"</span>, mirror <span class="op">=</span> <span class="st">"asia"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">data_ID</span> <span class="op">=</span> <span class="fu"><a href="reference/mi_get_ID.html">mi_get_ID</a></span><span class="op">(</span><span class="va">attributes</span>,biomart <span class="op">=</span> <span class="st">"genes"</span>, dataset <span class="op">=</span> <span class="st">"hsapiens_gene_ensembl"</span>, mirror <span class="op">=</span> <span class="st">"asia"</span><span class="op">)</span></span>
<span><span class="va">data_ID</span></span></code></pre></div>
<p>Sometimes the data obtained from other sources is an ID mapping table, with each row corresponding to an ID entity, and each column corresponds to a different database. So, do the training you need to reorganize the table and remove invalid values using the <code>mi_clean_data</code> function. For example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    <span class="st">"ensembl_gene_id"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ENSG00000001626"</span>,<span class="st">"ENSG00000002549"</span>,<span class="st">"ENSG00000002586"</span>,<span class="st">"ENSG00000002745"</span><span class="op">)</span>,</span>
<span>    <span class="st">'ensembl_exon_id'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ENSE00002398851"</span>,<span class="st">"ENSE00002398851"</span>,<span class="st">"ENSE00002398851"</span>,<span class="st">"ENSE00002398851"</span><span class="op">)</span>,</span>
<span>    <span class="st">'refseq_peptide'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NP_001303256"</span>,<span class="st">"-"</span>,<span class="st">"NP_001382772"</span>,<span class="st">"NP_001340728"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">data_ID_clean</span> <span class="op">=</span> <span class="fu"><a href="reference/mi_clean_data.html">mi_clean_data</a></span><span class="op">(</span><span class="va">data</span>,placeholder<span class="op">=</span><span class="st">"-"</span><span class="op">)</span></span>
<span><span class="va">data_ID_clean</span></span></code></pre></div>
<p>Further processing of IDs is needed for training. The first step is to split the IDs into multiple columns character by character. The IDs is filled with “*” up to the maximum length of IDs to guarantee consistent data dimension. Users can also specify the <code>pad_len</code> parameter to control the number of features used in the following training.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pad_len</span> <span class="op">=</span> <span class="fu"><a href="reference/mi_get_padlen.html">mi_get_padlen</a></span><span class="op">(</span><span class="va">data_ID</span><span class="op">)</span></span>
<span><span class="va">data_splt</span> <span class="op">=</span> <span class="fu"><a href="reference/mi_split_col.html">mi_split_col</a></span><span class="op">(</span><span class="va">data_ID</span>,cores <span class="op">=</span> <span class="cn">NULL</span>,pad_len <span class="op">=</span> <span class="va">pad_len</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">data_splt</span><span class="op">)</span></span></code></pre></div>
<p>The IDs has been split into several columns with single characters, which is not available for training. The <code>mi_to_numer</code> function specifies the levels of each feature column prefixed with “pos” and converts them into <code>factor</code> type. To learn more about R <code>factor</code>, please refer to <a href="https://r4ds.had.co.nz/factors.html" class="external-link">here</a>. For the concern of compatibility, the feature columns are then converted into <code>integer</code> type which can directly be used for training.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_fct</span> <span class="op">=</span> <span class="fu"><a href="reference/mi_to_numer.html">mi_to_numer</a></span><span class="op">(</span><span class="va">data_splt</span>,levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"*"</span>, <span class="fl">0</span><span class="op">:</span><span class="fl">9</span>, <span class="va">letters</span>, <span class="va">LETTERS</span>, <span class="st">"_"</span>, <span class="st">"."</span>, <span class="st">"-"</span>, <span class="st">" "</span>, <span class="st">"/"</span>, <span class="st">"\\"</span>, <span class="st">":"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Features are then all converted to numeric type while the target column <code>class</code> remains <code>factor</code> type.</p>
</div>
<div class="section level3">
<h3 id="data-balancing">Data balancing<a class="anchor" aria-label="anchor" href="#data-balancing"></a>
</h3>
<p>To prevent the trained model from losing its ability to distinguish between databases with small numbers of IDs, it is necessary to balance the data. On the one hand, the smote method is used to oversample databases with small numbers of IDs to increase the data density, and on the other hand, databases with large numbers of IDs are undersampled through random sampling to reduce the number of IDs.</p>
<p>The performing of data balancing in the function <code>mi_balance_data</code> is based on <code>scutr</code> package, allowing parallel only for Mac computers. The data set produced by balancing cannot be used as the test set, so the <code>ratio</code> proportion of the original data set is divided as the test set, and this portion of the data is removed from the balanced data set, while the remaining portion is used as the training set.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_blcd</span> <span class="op">=</span> <span class="fu"><a href="reference/mi_balance_data.html">mi_balance_data</a></span><span class="op">(</span><span class="va">data_fct</span>,ratio <span class="op">=</span> <span class="fl">0.3</span>,parallel <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">train</span> <span class="op">=</span> <span class="va">data_blcd</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="op">-</span><span class="va">class</span>,.fns <span class="op">=</span> <span class="op">~</span><span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html" class="external-link">replace_na</a></span><span class="op">(</span><span class="va">.x</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_blcd</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="fl">10000</span><span class="op">)</span>, preserve <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span><span class="va">test</span> <span class="op">=</span> <span class="va">data_blcd</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">train</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data_fct</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>After data balancing, the number of majority and minority classes are generally balanced.</p>
</div>
<div class="section level3">
<h3 id="model-optimizing">Model optimizing<a class="anchor" aria-label="anchor" href="#model-optimizing"></a>
</h3>
<p>MantaID contains four machine-learning submodels: Classification and Regression Tree (CART), Random Forest (RF), eXtreme Gradient Boosting (XGBoost), and Back Propagation Neural Network (BPNN). For the first three models, we achieve <code>hyperband</code> tuning to find the best parameter configurations based on <code>mlr3hyperband</code> package. For further understanding of <code>hyperband</code> algorithm, please visit <a href="https://arxiv.org/abs/1603.06560" class="external-link">here</a>. In each iteration, a complete run of sequential halving is executed. In it, after evaluating each configuration on the same subset size, only a fraction of <code>1/eta</code> of them ‘advances’ to the next round. The paramter <code>eta</code> is default set to 3. In the <code>mi_tune_*</code> function, except for the performing of <code>hyperband</code> tuning, the stage plots are also drawn to manifest the “competition” between different parameter configurations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Decision Tree</span></span>
<span><span class="va">inst_rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mi_tune_rp.html">mi_tune_rp</a></span><span class="op">(</span><span class="va">train</span>, eta <span class="op">=</span> <span class="fl">3</span>, resampling <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"bootstrap"</span>, ratio <span class="op">=</span> <span class="fl">0.8</span>, repeats <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Random Forest</span></span>
<span><span class="va">inst_rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mi_tune_rg.html">mi_tune_rg</a></span><span class="op">(</span><span class="va">train</span>, eta <span class="op">=</span> <span class="fl">3</span>, resampling <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"bootstrap"</span>, ratio <span class="op">=</span> <span class="fl">0.8</span>, repeats <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#Xgboost</span></span>
<span><span class="va">inst_xgb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mi_tune_xgb.html">mi_tune_xgb</a></span><span class="op">(</span><span class="va">train</span>, eta <span class="op">=</span> <span class="fl">3</span>, resampling <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">rsmp</a></span><span class="op">(</span><span class="st">"bootstrap"</span>, ratio <span class="op">=</span> <span class="fl">0.8</span>, repeats <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">inst_rp</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">inst_rg</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">inst_xgb</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-training">Model training<a class="anchor" aria-label="anchor" href="#model-training"></a>
</h3>
<p>After tuning, the optimal parameter configuration calculated can be used for the following training by passing the tuner instances to the <code>mi_train_*</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Decision Tree</span></span>
<span><span class="va">result_rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mi_train_rp.html">mi_train_rp</a></span><span class="op">(</span><span class="va">train</span>, <span class="va">test</span>, measure <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr</a></span><span class="op">(</span><span class="st">"classif.acc"</span><span class="op">)</span>, instance <span class="op">=</span> <span class="va">inst_rp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#Random Forest</span></span>
<span><span class="va">result_rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mi_train_rg.html">mi_train_rg</a></span><span class="op">(</span><span class="va">train</span>, <span class="va">test</span>, measure <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr</a></span><span class="op">(</span><span class="st">"classif.acc"</span><span class="op">)</span>, instance <span class="op">=</span> <span class="va">inst_rg</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#Xgboost</span></span>
<span><span class="va">result_xgb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mi_train_xgb.html">mi_train_xgb</a></span><span class="op">(</span><span class="va">train</span>, <span class="va">test</span>, measure <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">msr</a></span><span class="op">(</span><span class="st">"classif.acc"</span><span class="op">)</span>, instance <span class="op">=</span> <span class="va">inst_xgb</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#BPNN</span></span>
<span><span class="va">result_BP</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mi_train_BP.html">mi_train_BP</a></span><span class="op">(</span><span class="va">train</span>, <span class="va">test</span>, path2save <span class="op">=</span> <span class="cn">NULL</span>, batch_size <span class="op">=</span> <span class="fl">128</span>, epochs <span class="op">=</span> <span class="fl">64</span>, validation_split <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h3>
<p>To evaluate the performance of models, the confusion matrices of test set are calculated and visualized with heatmap. Each row of the matrix represents the instances in an actual class while each column represents the instances in a predicted class, or vice versa.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">matri_rp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mi_get_confusion.html">mi_get_confusion</a></span><span class="op">(</span><span class="va">result_rp</span><span class="op">)</span></span>
<span><span class="va">matri_rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mi_get_confusion.html">mi_get_confusion</a></span><span class="op">(</span><span class="va">result_rg</span><span class="op">)</span></span>
<span><span class="va">matri_xgb</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mi_get_confusion.html">mi_get_confusion</a></span><span class="op">(</span><span class="va">result_xgb</span><span class="op">)</span></span>
<span><span class="va">matri_BP</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mi_get_confusion.html">mi_get_confusion</a></span><span class="op">(</span><span class="va">result_BP</span>,ifnet <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/mi_plot_heatmap.html">mi_plot_heatmap</a></span><span class="op">(</span><span class="va">matri_rp</span>, name<span class="op">=</span><span class="st">"rp"</span>,filepath <span class="op">=</span> <span class="st">"Graph/"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/mi_plot_heatmap.html">mi_plot_heatmap</a></span><span class="op">(</span><span class="va">matri_rg</span>, name<span class="op">=</span><span class="st">"rg"</span>,filepath <span class="op">=</span> <span class="st">"Graph/"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/mi_plot_heatmap.html">mi_plot_heatmap</a></span><span class="op">(</span><span class="va">matri_xgb</span>, name<span class="op">=</span><span class="st">"xgb"</span>,filepath <span class="op">=</span> <span class="st">"Graph/"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/mi_plot_heatmap.html">mi_plot_heatmap</a></span><span class="op">(</span><span class="va">matri_BP</span>, name<span class="op">=</span><span class="st">"BP"</span>,filepath <span class="op">=</span> <span class="st">"Graph/"</span><span class="op">)</span></span></code></pre></div>
<p>In the heatmaps, the value in the squares depicts the number of samples whose actual classes are <code>Reference</code>, while predicted as <code>Prediction</code>. For clarity, zero values are omitted. MantaID implements submodel unification based on a new method. For cases with a majority class in prediction results, MantaID adopts the voting method directly, while for cases with scattered opinions, MantaID calculates the score of results of each model to find the optimal result.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mi_data_rawID"</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="va">mi_data_rawID</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">class</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data_ID</span><span class="op">$</span><span class="va">class</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">final_result</span> <span class="op">=</span> <span class="fu"><a href="reference/mi_unify_mod.html">mi_unify_mod</a></span><span class="op">(</span><span class="va">data</span>, <span class="st">"ID"</span>,<span class="va">result_rg</span>,<span class="va">result_rp</span>,<span class="va">result_xgb</span>,<span class="va">result_BP</span>,c_value <span class="op">=</span> <span class="fl">0.75</span>, pad_len <span class="op">=</span> <span class="va">pad_len</span><span class="op">)</span></span>
<span><span class="va">final_result</span></span></code></pre></div>
<p>The <code>integrated</code> column is the final result MantaID determined. To prove the effectiveness of unification method, we can compare the balance accuracy by classes of test set. The integrated model inherits the individual models’ strengths well, scoring high in almost all classes when compared to the sub-models.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">balance_accuracy</span> <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_dfc</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">final_result</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">confusion</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/confusionMatrix.html" class="external-link">confusionMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">x</span>,reference <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">class</span><span class="op">)</span><span class="op">$</span><span class="va">byClass</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">confusion</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">select</a></span><span class="op">(</span><span class="va">`Balanced Accuracy`</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://magrittr.tidyverse.org/reference/aliases.html" class="external-link">set_names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">final_result</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">balance_accuracy</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="session-information">Session information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># R version 4.2.0 (2022-04-22 ucrt)</span></span>
<span><span class="co"># Platform: x86_64-w64-mingw32/x64 (64-bit)</span></span>
<span><span class="co"># Running under: Windows 10 x64 (build 19044)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Matrix products: default</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># locale:</span></span>
<span><span class="co">#   [1] LC_COLLATE=Chinese (Simplified)_China.utf8  LC_CTYPE=Chinese (Simplified)_China.utf8   </span></span>
<span><span class="co"># [3] LC_MONETARY=Chinese (Simplified)_China.utf8 LC_NUMERIC=C                               </span></span>
<span><span class="co"># [5] LC_TIME=Chinese (Simplified)_China.utf8    </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># attached base packages:</span></span>
<span><span class="co">#   [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># other attached packages:</span></span>
<span><span class="co">#   [1] devtools_2.4.4 usethis_2.1.6 </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># loaded via a namespace (and not attached):</span></span>
<span><span class="co">#   [1] tidyselect_1.2.0    xfun_0.30           remotes_2.4.2       purrr_1.0.0        </span></span>
<span><span class="co"># [5] reshape2_1.4.4      vctrs_0.5.1         generics_0.1.3      miniUI_0.1.1.1     </span></span>
<span><span class="co"># [9] htmltools_0.5.4     yaml_2.3.5          utf8_1.2.2          rlang_1.0.6        </span></span>
<span><span class="co"># [13] pkgbuild_1.3.1      pkgdown_2.0.7       urlchecker_1.0.1    pillar_1.8.1       </span></span>
<span><span class="co"># [17] later_1.3.0         withr_2.5.0         glue_1.6.2          DBI_1.1.3          </span></span>
<span><span class="co"># [21] sessioninfo_1.2.2   lifecycle_1.0.3     plyr_1.8.7          stringr_1.5.0      </span></span>
<span><span class="co"># [25] htmlwidgets_1.5.4   memoise_2.0.1       evaluate_0.19       knitr_1.40         </span></span>
<span><span class="co"># [29] callr_3.7.3         fastmap_1.1.0       httpuv_1.6.7        ps_1.7.2           </span></span>
<span><span class="co"># [33] fansi_1.0.3         Rcpp_1.0.9          xtable_1.8-4        promises_1.2.0.1   </span></span>
<span><span class="co"># [37] BiocManager_1.30.19 cachem_1.0.6        desc_1.4.1          pkgload_1.3.0      </span></span>
<span><span class="co"># [41] mime_0.12           fs_1.5.2            digest_0.6.31       stringi_1.7.8      </span></span>
<span><span class="co"># [45] processx_3.8.0      dplyr_1.0.9         shiny_1.7.4         rprojroot_2.0.3    </span></span>
<span><span class="co"># [49] cli_3.5.0           tools_4.2.0         magrittr_2.0.3      tibble_3.1.8       </span></span>
<span><span class="co"># [53] profvis_0.3.7       crayon_1.5.2        pkgconfig_2.0.3     ellipsis_0.3.2     </span></span>
<span><span class="co"># [57] prettyunits_1.1.1   assertthat_0.2.1    rmarkdown_2.16      rstudioapi_0.14    </span></span>
<span><span class="co"># [61] R6_2.5.1            compiler_4.2.0     </span></span></code></pre></div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=MantaID" class="external-link">View on CRAN</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing MantaID</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Zhengpeng Zeng <br><small class="roles"> Author, maintainer, contributor </small> <a href="https://orcid.org/0000-0001-7919-209X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Longfei Mao <br><small class="roles"> Author, copyright holder </small> <a href="https://orcid.org/0000-0003-0759-0501" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Feng Yu <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5221-281X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Zhengpeng Zeng, Longfei Mao, Feng Yu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
